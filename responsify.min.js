/*! responsify - v0.0.8 - eclifford <ericgclifford@gmail.com> - 2014-09-30 */!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.Responsify=b(a)}):"undefined"!=typeof exports?module.exports=b(a):a.Responsify=b(a)}(this,function(){"use strict";var a={version:"0.0.8",options:{namespace:"responsify",selector:"img.responsive,div.responsive",breakpoints:[{label:"break-a",enter:0,exit:765},{label:"break-b",enter:768,exit:991},{label:"break-c",enter:992,exit:1199},{label:"break-d",enter:1200,exit:1e4}],supportedWidths:[],supportedPixelDensity:[1,1.3,2]},currentBreakpoint:null,images:[],events:{},init:function(a){a&&this.extend(this.options,a),this.currentBreakpoint=this.findClosestBreakpoint(window.innerWidth),this.refreshImages(),this.setupEvents(),this.renderImages(this.images)},refreshImages:function(){this.images=[].slice.call(document.querySelectorAll(this.options.selector))},setupEvents:function(){var a=this;window.addEventListener("resize",function(){window.requestAnimationFrame(function(){a.onResizeEvent(window.innerWidth)})})},onResizeEvent:function(a){var b=this.findClosestBreakpoint(a);b!=this.currentBreakpoint&&(this.setBreakpoint(b),this.renderImages(this.images))},setBreakpoint:function(a){this.currentBreakpoint=a,this.publish("responsify:breakpoint:change",this.currentBreakpoint)},findClosestBreakpoint:function(a){for(var b=0;b<this.options.breakpoints.length;b++)if(a>=this.options.breakpoints[b].enter&&a<=this.options.breakpoints[b].exit)return this.options.breakpoints[b]},isBreakpointEqualTo:function(a){return a===this.currentBreakpoint.label},renderImages:function(a){for(var b=0;b<a.length;b++)this.renderImage(a[b])},renderImage:function(a){var b=a.getAttribute("data-"+this.options.namespace)||"",c=a.getAttribute("data-"+this.options.namespace+"-"+this.currentBreakpoint.label)||"",d="",e=0,f=1,g=0;d=this.buildImageURI(b,c),d.match(/{width}/g)&&(e=this.getClosestSupportedWidth(a.parentElement.clientWidth),f=this.getClosestsSupportedPixelRatio(this.getPixelRatio()),g=e*f,d=d.replace(/{width}/g,g)),"img"===a.nodeName.toLowerCase()?a.src!==d&&(a.src=d,this.publish("responsify:image:rendered",a)):(a.style.backgroundImage="url('"+d+"')",a.style.backgroundSize="cover",this.publish("responsify:image:rendered",a))},getClosestSupportedWidth:function(a){var b=this.options.supportedWidths.length,c=0;if(0===b)return a;for(;b--;)a<=this.options.supportedWidths[b]&&(c=this.options.supportedWidths[b]);return c},getPixelRatio:function(){return window.devicePixelRatio||1},getClosestsSupportedPixelRatio:function(a){for(var b=this.options.supportedPixelDensity.length,c=1;b--;)a<=this.options.supportedPixelDensity[b]&&(c=this.options.supportedPixelDensity[b]);return c},buildImageURI:function(a,b){var c="";if(-1!==b.indexOf("?")){var d=b.split("?");c=this.appendQueryString(a+d[0],d[1])}else c=-1!==b.indexOf("=")?this.appendQueryString(a,b):a+b;return c},appendQueryString:function(a,b){if(!b)return a;b=b.replace(/^(&|\?)/,"");var c=-1!==a.indexOf("?")?"&":"?";return a+c+b},addImage:function(a){this.images.push(a),this.renderImage(a)},addImages:function(a){for(var b=0;b<a.length;b++)this.addImage(a[b])},removeImage:function(a){for(var b=this.images.length;b--;)a===this.images[b]&&this.images.splice(b,1)},removeImages:function(a){for(var b=0;b<a.length;b++)this.removeImage(a[b])},publish:function(a){for(var b=this.events[a],c=b?b.length:0,d=[].slice.call(arguments,1);c--;)b[c].callback.apply(b[c].context,d)},on:function(a,b,c){this.events[a]||(this.events[a]=[]),this.events[a].push({callback:b,context:c||this})},extend:function(a,b){for(var c in b)a[c]="object"==typeof b[c]&&"[object Array]"!==Object.prototype.toString.call(b[c])?this.extend(a[c],b[c]):b[c];return a}};return window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)},a});